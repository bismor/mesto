(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.cloneNode(!0)}_setOnDeleteClick=()=>{this._element.remove()};_setOnLikeClick=e=>{e.target.classList.toggle("mesto__like-active")};_setOnOpenPicture=()=>{this._handleCardClick(this._link,this._name)};setEventListeners(){this._element.querySelector(".mesto__delete").addEventListener("click",this._setOnDeleteClick),this._element.querySelector(".mesto__like").addEventListener("click",this._setOnLikeClick),this._cardPict.addEventListener("click",this._setOnOpenPicture)}render=()=>(this._element=this._getTemplate(),this._cardPict=this._element.querySelector(".mesto__img"),this._cardPict.alt=this._name,this._cardPict.src=this._link,this._element.querySelector(".mesto__title").textContent=this._name,this.setEventListeners(),this._element)}const t={sectionSelector:".popup__section",inputSelector:".popup__text",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_inactive",inputErrorClass:".popup__input-error",errorClass:".popup__button_inactive",popupTextTypeError:"popup__text-type-error",formInputError:"popup__input-error_active"};class s{constructor(e,t){this._selectors=e,this._form=t,this._buttonElement=t.querySelector(e.submitButtonSelector),this._inputList=Array.from(t.querySelectorAll(e.inputSelector))}_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_showInputError(e,t){e.classList.add(this._selectors.popupTextTypeError),this._errorElement.classList.add(this._selectors.formInputError),this._errorElement.textContent=t}_hideInputError(e){e.classList.remove(this._selectors.popupTextTypeError),this._errorElement.classList.remove(this._selectors.formInputError),this._errorElement.textContent=""}_toggleButtonState=()=>{this._hasInvalidInput()?(this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._selectors.inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._selectors.inactiveButtonClass))};_checkInputValidity(e){this._isValid=e.validity.valid,this._formSection=e.closest(this._selectors.sectionSelector),this._errorElement=this._formSection.querySelector(this._selectors.inputErrorClass),this._isValid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setEventListeners(){const e=this._form;this._toggleButtonState(),e.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}),0)})),this._inputList.forEach((t=>{e.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}enableValidation=()=>{this._setEventListeners()}}class n{constructor(e){this._popupElement=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleOverlay=e=>{e.target.classList.contains("popup_opened")&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",this._handleOverlay),this._popupElement.querySelector(".popup__close").addEventListener("mousedown",this.close)}}class o extends n{constructor(e,t){super(e),this._callBackSumbit=t,this._popupForm=this._popupElement.querySelector(".popup__form"),this._handleSumbit=this._handleSumbit.bind(this)}_getInputValues(){const e={};return this._popupElement.querySelectorAll(".popup__text").forEach((t=>{e[t.name]=t.value})),e}_handleSumbit(e){e.preventDefault(),this._callBackSumbit(this._getInputValues()),super.close(),this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSumbit)}setFormValues(e){this._popupElement.querySelectorAll(".popup__text").forEach((t=>{t.value=e[t.name]}))}}document.querySelector(".mesto__ul");const r=document.querySelector(".cardPopup"),i=document.querySelector(".profilePopup"),p=document.querySelector(".profile__button"),l=document.querySelector(".button"),c=(document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),i.querySelector(".popup__name"),i.querySelector(".popup__job"),r.querySelector(".popup__name")),u=r.querySelector(".popup__job"),_=new s(t,i),a=new s(t,r);_.enableValidation(),a.enableValidation();const d=new class extends n{constructor(e){super(e),this._popupPictCont=document.querySelector(".popup__picture"),this._pictureName=this._popupPictCont.querySelector(".popup__subname"),this._popupScreen=this._popupPictCont.querySelector(".popup__screen")}open(e,t){super.open(),this._pictureName.textContent=e,this._popupScreen.src=t,this._popupScreen.alt=e}}(".imagePopup");d.setEventListeners();const h=new o(".profilePopup",(function(e){y.setUserInfo(e)}));h.setEventListeners();const m=new o(".cardPopup",(function(){const e=E({name:c.value,link:u.value});v.beforeaddItem(e)}));function E(t){return new e(t,".mesto__template",((e,t)=>{d.open(t,e)})).render()}m.setEventListeners();const v=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.append(e)}beforeaddItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=E(e);v.addItem(t)}},".mesto__ul");v.renderItems();const y=new class{constructor({userName:e,userinfo:t}){this._userName=document.querySelector(e),this._userinfo=document.querySelector(t)}getUserInfo(){const e={};return e.popup__name=this._userName.textContent,e.popup__job=this._userinfo.textContent,e}setUserInfo(e){this._userName.textContent=e.popup__name,this._userinfo.textContent=e.popup__job}}({userName:".profile__title",userinfo:".profile__subtitle"});p.addEventListener("click",(function(){const e=y.getUserInfo();h.open(),h.setFormValues(e)})),l.addEventListener("click",(function(){m.open()}))})();
//# sourceMappingURL=main.js.map